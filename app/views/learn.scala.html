@import model.{CardType, CompleteFlashcard, User, UserAnsweredFlashcard}

@(user: User, completeFlashcard: CompleteFlashcard, oldAnswer: Option[UserAnsweredFlashcard], isRepeating: Boolean)(
        implicit requestHeader: RequestHeader, messagesProvider: MessagesProvider)

    @title = @{
        "Lernen"
    }

    @scripts = {
        <script src="@routes.Assets.versioned("learn.js")"></script>
    }

    @choiceInputType = @{
        completeFlashcard.cardType match {
            case CardType.SingleChoice => "radio"
            case CardType.MultipleChoice => "checkbox"
            case _ => ""
        }
    }

    @main(title, Some(user), scripts) {
        @*<form onsubmit="checkSolution(); return false;">*@
        @helper.CSRF.formField

        <div class="row">
            <div class="col s12 l8 offset-l2" id="flashcardDiv" data-cardtype="@completeFlashcard.cardType">
                <div class="card-panel">
                    <h4 class="center-align">@completeFlashcard.question</h4>
                </div>

                <p class="center-align">
                    <code>
                        Stapel: @oldAnswer.map(_.bucketId).getOrElse(1), Versuche: <span id="triesSpan">@oldAnswer.map(_.tries).getOrElse(0)</span></code>
                </p>

                @completeFlashcard.cardType match {
                    case CardType.Vocable | CardType.Text | CardType.Blank => {
                        <div class="row">
                            <div class="input-field col s12">
                                <input type="text" id="translation_input" autofocus autocomplete="off">
                                <label for="translation_input">Übersetzung</label>
                            </div>
                        </div>
                    }
                    case CardType.SingleChoice | CardType.MultipleChoice => {
                        @for(answer <- scala.util.Random.shuffle(completeFlashcard.choiceAnswers)) {
                            <p>
                                <label for="choice_@answer.id">
                                    <input id="choice_@answer.id" name="choice_answers" type="@choiceInputType" data-choiceid="@answer.id">
                                    <span>@answer.answer</span>
                                </label>
                            </p>
                        }
                    }
                }

                <p id="correctionTextPar">&nbsp;</p>

                <button class="btn btn-large waves-effect green" onclick="checkSolution();" id="checkSolutionBtn"
                data-href="@routes.HomeController.checkSolution(completeFlashcard.langId, completeFlashcard.collId, completeFlashcard.id)">
                    Lösung testen
                </button>

                <a href="@routes.HomeController.startLearning(completeFlashcard.langId, completeFlashcard.collId, isRepeating)"
                id="nextFlashcardBtn" class="btn btn-large waves-effect blue disabled">Weiter</a>

            </div>
        </div>
        @*</form>*@
        <br>
    }

